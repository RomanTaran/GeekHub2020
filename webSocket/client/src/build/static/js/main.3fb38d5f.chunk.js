(this.webpackJsonptodomvc=this.webpackJsonptodomvc||[]).push([[0],{40:function(e,t,o){e.exports=o(85)},85:function(e,t,o){"use strict";o.r(t);var a={};o.r(a),o.d(a,"getTodos",(function(){return w})),o.d(a,"addTodo",(function(){return x})),o.d(a,"deleteTodo",(function(){return y})),o.d(a,"editTodo",(function(){return k})),o.d(a,"completeTodo",(function(){return j})),o.d(a,"completeAll",(function(){return S})),o.d(a,"clearCompleted",(function(){return N}));var l=o(0),c=o.n(l),n=o(10),d=o(5),s=o.n(d);class r extends l.Component{constructor(...e){super(...e),this.state={text:this.props.text||""},this.handleSubmit=e=>{const t=e.target.value.trim();13===e.which&&(this.props.onSave(t),this.props.newTodo&&this.setState({text:""}))},this.handleChange=e=>{this.setState({text:e.target.value})},this.handleBlur=e=>{this.props.newTodo||this.props.onSave(e.target.value)}}render(){return c.a.createElement("input",{className:s()({edit:this.props.editing,"new-todo":this.props.newTodo}),type:"text",placeholder:this.props.placeholder,autoFocus:!0,value:this.state.text,onBlur:this.handleBlur,onChange:this.handleChange,onKeyDown:this.handleSubmit})}}var i=({addTodo:e})=>c.a.createElement("header",{className:"header"},c.a.createElement("h1",null,"todos"),c.a.createElement(r,{newTodo:!0,onSave:t=>{0!==t.length&&e(t)},placeholder:"What needs to be done?"})),m=o(39);const p={show_all:"All",show_active:"Active",show_completed:"Completed"};var h=({visibilityFilter:e,activeCount:t,completedCount:o,setFilter:a,clearCompleted:l})=>{const n=1===t?"item":"items";return c.a.createElement("footer",{className:"footer"},c.a.createElement("span",{className:"todo-count"},c.a.createElement("strong",null,t||"No")," ",n," left"),c.a.createElement("ul",{className:"filters"},Object.keys(p).map(t=>c.a.createElement("li",{key:t},c.a.createElement("a",{className:s()({selected:t===e}),style:{cursor:"pointer"},onClick:()=>a(t)},p[t])))),!!o&&c.a.createElement("button",{className:"clear-completed",onClick:l},"Clear completed"))},u=o(1);class E extends l.Component{constructor(...e){super(...e),this.state={editing:!1},this.handleDoubleClick=()=>{this.setState({editing:!0})},this.handleSave=e=>{0===e.text.length?this.props.deleteTodo(e.id):this.props.editTodo(e),this.setState({editing:!1})}}render(){const e=this.props,t=e.todo,o=e.completeTodo,a=e.deleteTodo;let l;return l=this.state.editing?c.a.createElement(r,{text:t.text,editing:this.state.editing,onSave:e=>this.handleSave(Object(u.a)(Object(u.a)({},t),{},{text:e}))}):c.a.createElement("div",{className:"view"},c.a.createElement("input",{className:"toggle",type:"checkbox",checked:t.completed,onChange:()=>o(t._id,!t.completed)}),c.a.createElement("label",{onDoubleClick:this.handleDoubleClick},t.text),c.a.createElement("button",{className:"destroy",onClick:()=>a(t)})),c.a.createElement("li",{key:s()({id:t._id}),className:s()({completed:t.completed,editing:this.state.editing})},l)}}var T=({todos:e,editTodo:t,deleteTodo:o,completeTodo:a})=>c.a.createElement("ul",{className:"todo-list"},e.map(e=>c.a.createElement(E,{key:e._id,todo:e,editTodo:t,completeTodo:a,deleteTodo:o}))),O=o(35);var _=o.n(O)()("http://localhost:8000",{transports:["websocket","polling","flashsocket"]});var b=({todos:e,actions:{clearCompleted:t,completeAll:o,completeTodo:a,deleteTodo:n,editTodo:d,getTodos:s}})=>{const r=Object(l.useState)("show_all"),i=Object(m.a)(r,2),p=i[0],u=i[1];Object(l.useEffect)(()=>{s(),_.on("Data",()=>{console.log("OK"),s()})},[]);const E=e.length,O=e.filter(({completed:e})=>e).length;let b;switch(p){case"show_all":b=e;break;case"show_completed":b=e.filter(e=>e.completed);break;case"show_active":b=e.filter(e=>!e.completed);break;default:throw new Error("Unknown filter: "+p)}return c.a.createElement("section",{className:"main"},!!E&&c.a.createElement("span",null,c.a.createElement("input",{className:"toggle-all",type:"checkbox",checked:O===E,readOnly:!0}),c.a.createElement("label",{onClick:()=>o(e.filter(e=>!e.completed).map(e=>e._id))})),c.a.createElement(T,{todos:b,deleteTodo:n,editTodo:d,completeTodo:a}),!!E&&c.a.createElement(h,{visibilityFilter:p,setFilter:u,completedCount:O,activeCount:E-O,clearCompleted:t}))},v=o(2),g=o(11);var C=o(3),D=o.n(C);const f="http://localhost:8000/api/",w=()=>e=>D.a.get("".concat(f)).end((t,o)=>{e(t?{type:"GET_TODOS",data:[]}:{type:"GET_TODOS",data:JSON.parse(o.text)})}),x=e=>t=>D.a.post("".concat(f,"todo")).send({_id:Math.random(),text:e,completed:!1}).end((o,a)=>{_.emit("Data changed"),t({type:"ADD_TODO",_id:Math.random(),text:e,completed:!1})}),y=({_id:e})=>t=>D.a.delete("".concat(f,"/todo/").concat(e)).send({_id:e}).end((o,a)=>t({type:"DELETE_TODO",_id:e})),k=e=>t=>D.a.put("".concat(f,"/todo/").concat(e._id)).send(e).end((o,a)=>t({type:"EDIT_TODO",_id:e._id,text:e.text})),j=(e,t)=>o=>D.a.put("".concat(f,"/todo/complete/").concat(e)).send({completed:t}).end((a,l)=>o({type:"COMPLETE_TODO",_id:e,completed:t})),S=e=>t=>{var o=e.map(e=>new Promise((e,t)=>{D.a.put("".concat(f,"/todo/completeAll")).send({completed:!0}).end((t,o)=>e())}));Promise.all(o).then(e=>t({type:"COMPLETE_ALL"}))},N=e=>t=>{var o=e.map(e=>new Promise((t,o)=>{D.a.delete("".concat(f,"/todo/clearcompleted/").concat(e)).end((e,o)=>t())}));Promise.all(o).then(e=>t({type:"CLEAR_COMPLETED"}))};var L=Object(g.b)(e=>({todos:e.todos}),e=>({actions:Object(v.b)(a,e)}))(({todos:e,actions:t})=>c.a.createElement("div",null,c.a.createElement(i,{addTodo:t.addTodo}),c.a.createElement(b,{todos:e,actions:t}))),A=(o(84),o(38));const P=[];var M=Object(v.c)({todos:function(e=P,t){switch(t.type){case"GET_TODOS":return[...t.data];case"ADD_TODO":return[{_id:t._id,completed:t.completed,text:t.text},...e];case"DELETE_TODO":return e.filter(e=>e._id!==t._id);case"EDIT_TODO":return e.map(e=>e._id===t._id?Object(u.a)(Object(u.a)({},e),{},{text:t.text}):e);case"COMPLETE_TODO":return e.map(e=>e._id===t._id?Object(u.a)(Object(u.a)({},e),{},{completed:t.completed}):e);case"COMPLETE_ALL":const o=e.every(e=>e.completed);return e.map(e=>Object(u.a)(Object(u.a)({},e),{},{completed:!o}));case"CLEAR_COMPLETED":return e.filter(e=>!1===e.completed);default:return e}}});const F=Object(v.d)(M,Object(v.a)(A.a));Object(n.render)(c.a.createElement(g.a,{store:F},c.a.createElement(L,null)),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.3fb38d5f.chunk.js.map